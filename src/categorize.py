from collections import namedtuple


# Функция для определения категории по ключевым словам
def categorize_text(text):

    for id_cat, category in categories.items():
        if any(word in text for word in category.key_words):
            return id_cat

    # Возвращаем категорию "неопределно", если ключевые слова не найдены
    return 0


# Функция для определения приоритета текста на основе его эмоциональной окраски
def determine_priority(text):
    # Ключевые слова для высокого, среднего и низкого приоритета
    high_priority_keywords = [
        "срочно",
        "немедленно",
        "важно",
        "критический",
        "неотложный",
    ]
    medium_priority_keywords = [
        "проблема",
        "задержка",
        "необходимо",
        "требуется",
        "ожидается",
    ]
    low_priority_keywords = [
        "информация",
        "запрос",
        "пожелание",
        "рекомендация",
        "уведомление",
    ]

    # Проверка на ключевые слова высокого приоритета
    if any(keyword in text for keyword in high_priority_keywords):
        return priorities[1]  # Высокий

    # Проверка на ключевые слова среднего приоритета
    elif any(keyword in text for keyword in medium_priority_keywords):
        return priorities[2]  # Средний

    # Проверка на ключевые слова низкого приоритета
    elif any(keyword in text for keyword in low_priority_keywords):
        return priorities[3]  # Низкий

    # Проверка на восклицательные знаки как признак высокого приоритета
    elif "!" in text:
        return priorities[1]  # Высокий

    # Если ни одно из вышеуказанных условий не выполнено, возвращаем 'Не определен'
    else:
        return priorities[0]  # Не определен


def name_category(id):
    """Функция возвращает название по числовому id

    Args:
        id (int): id категории

    Returns:
        str: название категории
    """
    return categories[id].name


# Основная функция скрипта
def process_texts(text):

    category = categorize_text(text)
    priority = determine_priority(text)

    return {"category": category, "priority": priority}


# Категории и приоритеты
Category = namedtuple("Category", "name key_words")

categories = {
    0: Category(
        "Не определено",
        [
            "неизвестно",
            "неопределенный",
            "непонятно",
            "странно",
            "какая-то",
            "какое-то",
            "что-то",
        ],
    ),
    1: Category(
        "Финансовая система",
        [
            "деньги",
            "бюджет",
            "финансы",
            "инвестиции",
            "акции",
            "банк",
            "экономика",
            "доход",
            "расход",
            "баланс",
            "фондовый рынок",
            "налоги",
            "кредит",
            "депозит",
            "валюта",
            "облигации",
            "страхование",
            "рентабельность",
            "ликвидность",
            "финансовый отчет",
        ],
    ),
    2: Category(
        "Сетевая проблема",
        [
            "сеть",
            "интернет",
            "соединение",
            "маршрутизатор",
            "сервер",
            "IP",
            "VPN",
            "протокол",
            "шифрование",
            "порт",
            "Wi-Fi",
            "LAN",
            "WAN",
            "пинг",
            "трафик",
            "брандмауэр",
            "DNS",
            "провайдер",
            "безопасность сети",
            "скорость интернета",
        ],
    ),
    3: Category(
        "Почта",
        [
            "почта",
            "электронная почта",
            "письмо",
            "вложение",
            "спам",
            "рассылка",
            "SMTP",
            "IMAP",
            "почтовый сервер",
            "почтовый клиент",
            "фильтрация",
            "адресат",
            "отправитель",
            "тема письма",
            "подпись",
            "автоответчик",
            "массовая рассылка",
            "письмо-запрос",
            "конфиденциальность",
            "письмо-уведомление",
        ],
    ),
    4: Category(
        "Связь",
        [
            "связь",
            "телефон",
            "мобильный",
            "оператор",
            "сигнал",
            "звонок",
            "SMS",
            "голосовая почта",
            "роуминг",
            "SIM-карта",
            "LTE",
            "4G",
            "5G",
            "сотовая связь",
            "базовая станция",
            "абонент",
            "тариф",
            "минуты",
            "сообщение",
            "передача данных",
        ],
    ),
    5: Category(
        "Техника",
        [
            "техника",
            "компьютер",
            "принтер",
            "сканер",
            "ноутбук",
            "монитор",
            "жесткий диск",
            "USB",
            "мышь",
            "клавиатура",
            "процессор",
            "видеокарта",
            "RAM",
            "оперативная память",
            "SSD",
            "HDD",
            "материнская плата",
            "питание",
            "зарядное устройство",
            "гаджет",
        ],
    ),
    6: Category(
        "Безопасность",
        [
            "безопасность",
            "вирус",
            "антивирус",
            "шпионское ПО",
            "фишинг",
            "хакер",
            "защита данных",
            "шифрование",
            "пароль",
            "доступ",
            "биометрия",
            "отпечаток пальца",
            "лицензия",
            "бэкап",
            "восстановление данных",
            "контроль доступа",
            "аудит",
            "угроза",
            "безопасность приложений",
            "компьютерная безопасность",
        ],
    ),
    7: Category(
        "Операционная система",
        [
            "операционная система",
            "Windows",
            "Linux",
            "macOS",
            "обновление",
            "установка",
            "драйвер",
            "системный файл",
            "реестр",
            "командная строка",
            "терминал",
            "пользовательский интерфейс",
            "GUI",
            "процесс",
            "задача",
            "память",
            "диспетчер задач",
            "настройки системы",
            "безопасный режим",
            "системный журнал",
        ],
    ),
    8: Category(
        "Office",
        [
            "Office",
            "Word",
            "Excel",
            "PowerPoint",
            "Outlook",
            "редактирование",
            "таблица",
            "презентация",
            "документ",
            "шаблон",
            "форматирование",
            "диаграмма",
            "график",
            "макрос",
            "функция",
            "формула",
            "сортировка",
            "фильтрация",
            "почтовый слияние",
            "электронные таблицы",
        ],
    ),
}

priorities = {0: "Не определен", 1: "Высокий", 2: "Средний", 3: "Низкий"}
